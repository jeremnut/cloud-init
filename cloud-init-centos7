#cloud-config
password: changeme
disable_root: False
ssh_pwauth: True
hostname: test01-ci
fqdn: test01-ci.int.virtualy-labs.com
manage_etc_hosts: true
users:
  - name: "admin"
    groups: sudo
    shell: /bin/bash
    lock_passwd: false
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
chpasswd:
 list: |
   admin:changeme
 expire: False
write_files:
  - path: /etc/sysconfig/network-scripts/ifcfg-eth0
    content: |
      DEVICE=eth0
      TYPE=Ethernet
      ONBOOT=yes
      BOOTPROTO=none
      IPADDR=192.168.13.100
      NETMASK=255.255.255.0
      GATEWAY=192.168.13.1
      DOMAIN=int.virtualy-labs.com
      DNS1=192.168.1.31
write_files:
  - path: /etc/yum.repos.d/CentOS-Base.repo
    owner: root:root
    permissions: '0444'
    content: |
      # installed by cloud-init
      [base]
      name=CentOS-$releasever - Base
      baseurl=http://mirrors.cat.pdx.edu/centos/$releasever/os/$basearch/
      gpgcheck=1
      gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
      #released updates 
      [updates]
      name=CentOS-$releasever - Updates
      baseurl=http://mirrors.cat.pdx.edu/centos/$releasever/updates/$basearch/
      gpgcheck=1
      gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
      #additional packages that may be useful
      [extras]
      name=CentOS-$releasever - Extras
      baseurl=http://mirrors.cat.pdx.edu/centos/$releasever/extras/$basearch/
      gpgcheck=1
      gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7  

# install Apache 
packages:
  - httpd
runcmd:
  - systemctl disable NetworkManager kdump
  - systemctl stop NetworkManager kdump
  - systemctl enable network.service
  - systemctl restart network.service
  - [ systemctl, enable, httpd.service ]
  - [ systemctl, start, httpd.service ]
